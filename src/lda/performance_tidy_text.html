---
title: "Exploring Job Performance Scales"
description: "An examination of our collected job performance scales"
tags: ["R", "text analysis", "tidytext", "sentiment"]
author: "Liz Miller"
date: "7/22/2020"
output: html_document
---



<div id="tidy-text-analysis-for-job-performance-scales" class="section level2">
<h2>Tidy Text Analysis for Job Performance Scales</h2>
<pre class="r"><code>library(dplyr)
library(tidyverse)
library(tidytext)
library(stm)
library(quanteda)
library(ggplot2)
library(readr)
library(stringr)
library(reshape2)
library(wordcloud)
library(readxl)

job_perf &lt;- read_excel(&quot;/project/class/bii_sdad_dspg/uva/dod_ari2/DSPG-ARI2 -- Performance Item and Scale Database.xlsx&quot;,  sheet = &quot;Performance Items&quot;)

soldier_effective &lt;- job_perf %&gt;%
  filter(CITATION == &quot;Borman, W. C., Motowidlo, S. J., Rose, S. R., &amp; Hanser, L. M. (1987). Development of a Model of Soldier Effectiveness: Retranslation Materials and Results. HUMAN RESOURCES RESEARCH ORGANIZATION ALEXANDRIA VA.&quot;)

job_perf &lt;- job_perf %&gt;%
  filter(CITATION != &quot;Borman, W. C., Motowidlo, S. J., Rose, S. R., &amp; Hanser, L. M. (1987). Development of a Model of Soldier Effectiveness: Retranslation Materials and Results. HUMAN RESOURCES RESEARCH ORGANIZATION ALEXANDRIA VA.&quot;)

#Grouping by scale source/citation if we want to consider texts as documents
cols &lt;- c(&#39;STEM&#39;, &#39;ITEM&#39;)
job_perf$scale &lt;- apply( job_perf[ , cols ], 1 , paste, collapse = &quot; &quot;)
job_perf$scale &lt;- gsub(&quot;NA&quot;,&#39; &#39;, job_perf$scale)

job_perf &lt;- job_perf %&gt;%
  group_by(CITATION, SCALE_NAME, SOURCE_DOMAIN, YEAR) %&gt;%
  summarise(scale = paste0(scale, collapse = &quot; &quot;))</code></pre>
</div>
<div id="basic-overview-of-dataset" class="section level2">
<h2>Basic overview of dataset</h2>
<pre class="r"><code>job_perf %&gt;%
  ggplot(aes(x = YEAR)) +
  geom_histogram(binwidth = 4, fill = &quot;blue&quot;) +
  ggtitle(&quot;Scale Years&quot;)</code></pre>
<p><img src="/findings/performance_tidy_text_files/figure-html/eda-1.png" width="672" /></p>
<pre class="r"><code>job_perf %&gt;%
  ggplot(aes(x = SOURCE_DOMAIN, fill = as.factor(SOURCE_DOMAIN))) +
  geom_bar(show.legend = FALSE) +
  ggtitle(&quot;Source of Scales&quot;)</code></pre>
<p><img src="/findings/performance_tidy_text_files/figure-html/eda-2.png" width="672" /></p>
</div>
<div id="word-frequency-in-scales" class="section level2">
<h2>Word Frequency in Scales</h2>
<pre class="r"><code>#Tidying the data

tidy_perf &lt;- tibble(domain = job_perf$SOURCE_DOMAIN, text = job_perf$scale)
data(stop_words)

tidy_perf &lt;- tidy_perf %&gt;%
  unnest_tokens(word, text) %&gt;%
  anti_join(stop_words) %&gt;%
  count(domain, word, sort = TRUE)
  
tidy_perf %&gt;%
  count(word, sort = TRUE) %&gt;%
  filter(n &gt; 5) %&gt;%
  mutate(word = reorder(word, n)) %&gt;%
  ggplot(aes(word, n, fill = word)) +
  geom_col(show.legend = FALSE) +
  xlab(NULL) +
  coord_flip() +
  ggtitle(&quot;Highest Frequency Words in Job Performance Scales&quot;)</code></pre>
<p><img src="/findings/performance_tidy_text_files/figure-html/into_tidy-1.png" width="672" /></p>
</div>
<div id="sentiment-analysis-with-job-performance-scales" class="section level2">
<h2>Sentiment Analysis with Job Performance Scales</h2>
<pre class="r"><code>perf_sentiment &lt;- tidy_perf %&gt;%
  inner_join(get_sentiments(&quot;bing&quot;)) %&gt;%
  count(word, sentiment, sort = TRUE) %&gt;%
  ungroup()

perf_sentiment %&gt;%
  group_by(sentiment) %&gt;%
  top_n(10) %&gt;%
  ungroup() %&gt;%
  mutate(word = reorder(word, n)) %&gt;%
  ggplot(aes(word, n, fill = sentiment)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~sentiment, scales = &quot;free_y&quot;) +
  labs(y = &quot;Contribution to sentiment&quot;,
       x = NULL) +
  coord_flip()</code></pre>
<p><img src="/findings/performance_tidy_text_files/figure-html/sentiment_analysis-1.png" width="672" /></p>
<pre class="r"><code>tidy_perf %&gt;%
  inner_join(get_sentiments(&quot;bing&quot;)) %&gt;%
  count(word, sentiment, sort = TRUE) %&gt;%
  acast(word ~ sentiment, value.var = &quot;n&quot;, fill = 0) %&gt;%
  comparison.cloud(colors = c(&quot;#1b2a49&quot;, &quot;#00909e&quot;), 
                   max.words = 100)</code></pre>
<p><img src="/findings/performance_tidy_text_files/figure-html/sentiment_analysis-2.png" width="672" /></p>
<p>Done</p>
</div>
